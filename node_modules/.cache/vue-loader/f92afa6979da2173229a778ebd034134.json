{"remainingRequest":"/home/hobo/code/odd6871/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/hobo/code/odd6871/src/components/subpage/Filemanagement.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/hobo/code/odd6871/src/components/subpage/Filemanagement.vue","mtime":1588543219625},{"path":"/home/hobo/code/odd6871/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/hobo/code/odd6871/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/home/hobo/code/odd6871/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/hobo/code/odd6871/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBTcGFya01ENSBmcm9tICdzcGFyay1tZDUnOwppbXBvcnQgYXhpb3MgZnJvbSAnYXhpb3MnOwppbXBvcnQgZm9sZGVyaXRlbSBmcm9tICIuL0ZpbGVpdGVtcy9mb2xkZXJpdGVtIjsKaW1wb3J0IGZpbGVpdGVtIGZyb20gIi4vRmlsZWl0ZW1zL2ZpbGVpdGVtIjsKZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICdGaWxlbWFuYWdlbWVudCcsCiAgZGF0YSAoKQogIHsKICAgIHJldHVybnsKICAgICAgZmlsZUxpc3Q6W3t9XSwKICAgICAgZm9sZGVyaXRlbXM6IFtdLAogICAgICBmaWxlaXRlbXM6IFtdLAogICAgICBjdXJyZW50X2Rpcl9pZDogLTEsCiAgICAgIGN1cnJlbnRfZGlyX25hbWU6ICdBbGwgZmlsZXMnLAogICAgICBwcmVfZGlyX2lkOiAwLAogICAgICBuZXdmb2xkZXJzaG93OiBmYWxzZSwKICAgICAgbmV3Zm9sZGVybmFtZToiIiwKICAgICAgdXBsb2FkcGVyY2VudGFnZTowLAogICAgICB1cGxvYWRwZXJjZW50YWdlc2hvdzogImRpc3BsYXk6bm9uZSIsCiAgICB9OwogIH0sCiAgY29tcG9uZW50czoKICB7CiAgICBmb2xkZXJpdGVtLAogICAgZmlsZWl0ZW0KICB9LAogIG1ldGhvZHM6CiAgewogICAgZmx1c2hEaXIobmV3RGlyKQogICAgewogICAgICB0aGlzLmN1cnJlbnRfZGlyX2lkID0gbmV3RGlyLmRpcklEOwogICAgICB0aGlzLmZvbGRlcml0ZW1zID0gW107CiAgICAgIHRoaXMuZmlsZWl0ZW1zID0gW107CiAgICAgIHRoaXMuJGFwaS5nZXQoJy9hcGkvZGlycy8nK3RoaXMuY3VycmVudF9kaXJfaWQsCiAgICAgIHsKICAgICAgICAneC1hdXRoLXRva2VuJzogdGhpcy5Db21tb24ueHRva2VuCiAgICAgIH0sIAogICAgICB7CiAgICAgICAgb25seV9kaXI6IGZhbHNlICAgICAgICAgICAgICAgICAgICAgICAvLycxMjMxMjM0JwogICAgICB9LCByZXNwb25zZSA9PiB7CiAgICAgIGlmIChyZXNwb25zZS5zdGF0dXMgPT0gMjAwKSAKICAgICAgewogICAgICAgIHZhciBmb2xkZXJzbGlzdDsKICAgICAgICB2YXIgZmlsZXNsaXN0OwogICAgICAgIHRoaXMucHJlX2Rpcl9pZD1yZXNwb25zZS5kYXRhLnJlc3VsdF9kYXRhLnByZV9pZDsKICAgICAgICBpZihyZXNwb25zZS5kYXRhLnJlc3VsdF9kYXRhLnByZV9pZCA9PSAwKQogICAgICAgIHsKICAgICAgICAgIHRoaXMuY3VycmVudF9kaXJfbmFtZT0iQWxsIGZpbGVzIgogICAgICAgIH0KICAgICAgICBlbHNlCiAgICAgICAgewogICAgICAgICAgdGhpcy5jdXJyZW50X2Rpcl9uYW1lPXJlc3BvbnNlLmRhdGEucmVzdWx0X2RhdGEubmFtZSsiLyIKICAgICAgICB9CiAgICAgICAgZm9sZGVyc2xpc3QgPSByZXNwb25zZS5kYXRhLnJlc3VsdF9kYXRhLmRpcnM7CiAgICAgICAgZmlsZXNsaXN0ID0gcmVzcG9uc2UuZGF0YS5yZXN1bHRfZGF0YS5maWxlczsKICAgICAgICBmb3IgKHZhciBrZXlmb2xkZXIgaW4gZm9sZGVyc2xpc3QpCiAgICAgICAgewogICAgICAgICAgdGhpcy5mb2xkZXJpdGVtcy5wdXNoKHtnZXRuYW1lOiBmb2xkZXJzbGlzdFtrZXlmb2xkZXJdLm5hbWUsIGdldGlkOiBmb2xkZXJzbGlzdFtrZXlmb2xkZXJdLmlkLCBnZXRwcmVpZDogdGhpcy5jdXJyZW50X2Rpcl9pZCwgZ2V0ZGF0ZTogZm9sZGVyc2xpc3Rba2V5Zm9sZGVyXS5jcmVhdGVfZGF0ZX0pOwogICAgICAgIH0KICAgICAgICBmb3IgKHZhciBrZXlmaWxlIGluIGZpbGVzbGlzdCkKICAgICAgICB7CiAgICAgICAgICB0aGlzLmZpbGVpdGVtcy5wdXNoKHtnZXRuYW1lOiBmaWxlc2xpc3Rba2V5ZmlsZV0ubmFtZSsiLiIrZmlsZXNsaXN0W2tleWZpbGVdLnN1ZmZpeGVzLCBnZXRzaXplOiBmaWxlc2xpc3Rba2V5ZmlsZV0uc2l6ZSwgZ2V0aWQ6IGZpbGVzbGlzdFtrZXlmaWxlXS5pZCwgZ2V0cHJlaWQ6IHRoaXMuY3VycmVudF9kaXJfaWQsZ2V0ZGF0ZTpmaWxlc2xpc3Rba2V5ZmlsZV0uY3JlYXRlX2RhdGV9KTsKICAgICAgICB9CiAgICAgICAgCiAgICAgIH0gCiAgICAgIGVsc2UgaWYocmVzcG9uc2Uuc3RhdHVzID09IDQwMCkKICAgICAgewogICAgICAgIGFsZXJ0KHJlc3BvbnNlLmRhdGEubXNnKTsKICAgICAgICAKICAgICAgfQogICAgICBlbHNlIGlmKHJlc3BvbnNlLnN0YXR1cyA9PSA0MDMpCiAgICAgIHsKICAgICAgICBhbGVydChyZXNwb25zZS5kYXRhLm1zZyk7CiAgICAgICAgCiAgICAgIH0KICAgICAgZWxzZQogICAgICB7CiAgICAgICAgYWxlcnQoIk5ldHdvcmsgRXJyb3IiKTsKICAgICAgICBjb25zb2xlLmxvZyhyZXNwb25zZSk7CiAgICAgIH0KICAgICAgfSk7CiAgICB9LAoKICAgIHVwbG9hZChyZXMpCiAgICB7CiAgICAgIGxldCBmaWxlID0gcmVzLmZpbGU7ICAvL+azqOaEj++8muebtOaOpeS4iuS8oGZpbGXmlofku7bvvIzkuI3opoHnlKhGb3JtRGF0YeWvueixoeeahOW9ouW8j+S8oAoKICAgICAgdGhpcy51cGxvYWRwZXJjZW50YWdlc2hvdz0iZGlzcGxheTppbmxpbmUiOwogICAgICB0aGlzLmdlbmVyYXRvckZpbGVNZDUoZmlsZSk7CgogICAgICAvL+S7juaOpeWPo+iOt+WPlnByZXNpZ25lZCB1cmwKICAgICAgICAgICAgICAvL+mcgOimgeeUqHB1dOaWueazleS4iuS8oO+8jHBvc3TkvJrmiqU0MDXvvIxhd3Plrpjmlrnop4TlrprmmK9wdXTmlrnms5UKICAgICAgLy8gYXhpb3MucHV0KHByZXNpZ25lZFVybCwgZmlsZSwgY29uZmlnKQogICAgICAvLyAgICAgLnRoZW4ocmVzMSA9PiB7CiAgICAgIC8vICAgICAgICAgaWYgKHJlczEuc3RhdHVzID09IDIwMCkgewogICAgICAvLyAgICAgICAgICAgY29uc29sZS5sb2cocmVzMSk7CiAgICAgIC8vICAgICAgICAgfQogICAgICAvLyAgICAgfSk7CiAgICB9LAogICAgZ2VuZXJhdG9yRmlsZU1kNShmaWxlKSB7CiAgICAgIC8qKgogICAgICAgICog55Sf5oiQTUQ1CiAgICAgICAgKi8KICAgICAgbGV0IGJsb2JTbGljZSA9IEZpbGUucHJvdG90eXBlLnNsaWNlIHx8IEZpbGUucHJvdG90eXBlLm1velNsaWNlIHx8IEZpbGUucHJvdG90eXBlLndlYmtpdFNsaWNlCiAgICAgICAgLy8gZmlsZSA9IHRoaXMuZmlsZXNbMF0sCiAgICAgIGxldCBjaHVua1NpemUgPSAyMDk3MTUyICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gUmVhZCBpbiBjaHVua3Mgb2YgMk1CCiAgICAgIGxldCBjaHVua3MgPSBNYXRoLmNlaWwoZmlsZS5zaXplIC8gY2h1bmtTaXplKQogICAgICBsZXQgY3VycmVudENodW5rID0gMAogICAgICBsZXQgc3BhcmsgPSBuZXcgU3BhcmtNRDUuQXJyYXlCdWZmZXIoKQogICAgICBsZXQgZmlsZVJlYWRlciA9IG5ldyBGaWxlUmVhZGVyKCkKICAgICAgY29uc3QgX3RoaXM9dGhpczsKICAgICAgZmlsZVJlYWRlci5vbmxvYWQgPSBmdW5jdGlvbiAoZSkgewogICAgICAgICAgLy8gY29uc29sZS5sb2coJ3JlYWQgY2h1bmsgbnInLCBjdXJyZW50Q2h1bmsgKyAxLCAnb2YnLCBjaHVua3MpCiAgICAgICAgICBzcGFyay5hcHBlbmQoZS50YXJnZXQucmVzdWx0KSAgICAgICAgICAgICAgICAgIC8vIEFwcGVuZCBhcnJheSBidWZmZXIKICAgICAgICAgIGN1cnJlbnRDaHVuaysrOwoKICAgICAgICAgIGlmIChjdXJyZW50Q2h1bmsgPCBjaHVua3MpIHsKICAgICAgICAgICAgICBsb2FkTmV4dCgpOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAvLyBjb25zb2xlLmluZm8oJ2NvbXB1dGVkIGhhc2gnLCBzcGFyay5lbmQoKSkgIC8vIHNwYXJrLmVuZCgpOiDmlofku7YgTUQ15YC855Sf5oiQ5a6M5oiQCiAgICAgICAgICAgICAgdmFyIG1kNWNvZGU9c3BhcmsuZW5kKCk7CiAgICAgICAgICAgICAgX3RoaXMudXBsb2FkcGVyY2VudGFnZT0xMDsKICAgICAgICAgICAgICBfdGhpcy4kYXBpLmdldCgnL2FwaS91cGxvYWQnLAogICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICd4LWF1dGgtdG9rZW4nOiBfdGhpcy5Db21tb24ueHRva2VuCiAgICAgICAgICAgICAgfSwgCiAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgZmlsZU5hbWU6IGZpbGUubmFtZSwKICAgICAgICAgICAgICAgIGZpbGVTaXplOiBmaWxlLnNpemUsCiAgICAgICAgICAgICAgICBmaWxlTUQ1OiBtZDVjb2RlLAogICAgICAgICAgICAgICAgZGlySWQ6IF90aGlzLmN1cnJlbnRfZGlyX2lkCiAgICAgICAgICAgICAgfSwgcmVzcG9uc2UgPT4gewogICAgICAgICAgICAgIGlmIChyZXNwb25zZS5zdGF0dXMgPT0gMjAwKSAKICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBpZihyZXNwb25zZS5kYXRhLnJlc3VsdF9kYXRhLnVwbG9hZF91cmwgIT0gbnVsbCkKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgdmFyIHVwbG9hZHVybDsKICAgICAgICAgICAgICAgICAgdmFyIHVwbG9hZGtleTsKICAgICAgICAgICAgICAgICAgdXBsb2FkdXJsPXJlc3BvbnNlLmRhdGEucmVzdWx0X2RhdGEudXBsb2FkX3VybDsKICAgICAgICAgICAgICAgICAgdXBsb2Fka2V5PXJlc3BvbnNlLmRhdGEucmVzdWx0X2RhdGEudXBsb2FkX2tleTsKICAgICAgICAgICAgICAgICAgbGV0IGNvbmZpZyA9IHtoZWFkZXJzOiB7J0NvbnRlbnQtVHlwZSc6ICdtdWx0aXBhcnQvZm9ybS1kYXRhJ30sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uVXBsb2FkUHJvZ3Jlc3M6IHByb2dyZXNzRXZlbnQgPT4gewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMudXBsb2FkcGVyY2VudGFnZSA9IHBhcnNlSW50KChwcm9ncmVzc0V2ZW50LmxvYWRlZCAvIHByb2dyZXNzRXZlbnQudG90YWwgKiA5MCkrMTApOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH19OwoKICAgICAgICAgICAgICAgICAgICAvL+S7juaOpeWPo+iOt+WPlnByZXNpZ25lZCB1cmwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8v6ZyA6KaB55SocHV05pa55rOV5LiK5Lyg77yMcG9zdOS8muaKpTQwNe+8jGF3c+WumOaWueinhOWumuaYr3B1dOaWueazlQogICAgICAgICAgICAgICAgICAgIGF4aW9zLnB1dCh1cGxvYWR1cmwsIGZpbGUsIGNvbmZpZykKICAgICAgICAgICAgICAgICAgICAudGhlbihyZXMxID0+IHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJlczEuc3RhdHVzID09IDIwMCkgewogICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBqc29uZGF0YT1KU09OLnN0cmluZ2lmeSh7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiZmlsZV9uYW1lIjogZmlsZS5uYW1lLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgInNpemUiOiBmaWxlLnNpemUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAibWQ1IjogbWQ1Y29kZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJkaXJfaWQiOiBfdGhpcy5jdXJyZW50X2Rpcl9pZCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJ1cGxvYWRfa2V5IjogdXBsb2Fka2V5CiAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMuJGh0dHAyLnBvc3QoX3RoaXMuQ29tbW9uLmJhc2V1cmwrIi9hcGkvdXBsb2FkIiwgCiAgICAgICAgICAgICAgICAgICAgICAgICAganNvbmRhdGEsIAogICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhlYWRlcnM6IHsneC1hdXRoLXRva2VuJzogX3RoaXMuQ29tbW9uLnh0b2tlbiwgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJ30KICAgICAgICAgICAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgICAgICAgICAgIC50aGVuKHJlc3BvbnNlID0+IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJlc3BvbnNlLnN0YXR1cyA9PSAyMDApIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy4kbm90aWZ5KHt0aXRsZTogJ05vdGlmaWNhdGlvbicsbWVzc2FnZTogJ1N1Y2Nlc3MhJyxkdXJhdGlvbjogMzAwMH0pOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBuZXh0ZGlyPXtkaXJJRDogX3RoaXMuY3VycmVudF9kaXJfaWR9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMuZmx1c2hEaXIobmV4dGRpcik7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMudXBsb2FkcGVyY2VudGFnZXNob3c9ImRpc3BsYXk6bm9uZSI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgICAgICAgICAgIC5jYXRjaChmdW5jdGlvbiAoZXJyb3IpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGVycm9yLnJlc3BvbnNlKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLnVwbG9hZHBlcmNlbnRhZ2VzaG93PSJkaXNwbGF5Om5vbmUiOwogICAgICAgICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgICAgICAuY2F0Y2goZnVuY3Rpb24gKGVycm9yKSB7CiAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhlcnJvci5yZXNwb25zZSk7CiAgICAgICAgICAgICAgICAgICAgICBfdGhpcy51cGxvYWRwZXJjZW50YWdlc2hvdz0iZGlzcGxheTpub25lIjsKICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgX3RoaXMuJG5vdGlmeSh7dGl0bGU6ICdOb3RpZmljYXRpb24nLG1lc3NhZ2U6ICdTdWNjZXNzIScsZHVyYXRpb246IDMwMDB9KTsKICAgICAgICAgICAgICAgICAgdmFyIG5leHRkaXI9e2RpcklEOiBfdGhpcy5jdXJyZW50X2Rpcl9pZH0KICAgICAgICAgICAgICAgICAgX3RoaXMuZmx1c2hEaXIobmV4dGRpcik7CiAgICAgICAgICAgICAgICAgIF90aGlzLnVwbG9hZHBlcmNlbnRhZ2U9MTAwOwogICAgICAgICAgICAgICAgICBfdGhpcy51cGxvYWRwZXJjZW50YWdlc2hvdz0iZGlzcGxheTpub25lIjsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9IAogICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBhbGVydCgiRXJyb3I6IityZXNwb25zZS5kYXRhLm1zZyk7CiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhyZXNwb25zZSk7CiAgICAgICAgICAgICAgICBfdGhpcy51cGxvYWRwZXJjZW50YWdlc2hvdz0iZGlzcGxheTpub25lIjsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgfQogICAgICB9OwoKICAgICAgZmlsZVJlYWRlci5vbmVycm9yID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgY29uc29sZS53YXJuKCdmaWxlUmVhZGVyLm9uZXJyb3IgaXMgZXJyb3InKQogICAgICB9OwoKICAgICAgZnVuY3Rpb24gbG9hZE5leHQoKSB7CiAgICAgICAgICB2YXIgc3RhcnQgPSBjdXJyZW50Q2h1bmsgKiBjaHVua1NpemUsCiAgICAgICAgICAgICAgZW5kID0gKChzdGFydCArIGNodW5rU2l6ZSkgPj0gZmlsZS5zaXplKSA/IGZpbGUuc2l6ZSA6IHN0YXJ0ICsgY2h1bmtTaXplOwoKICAgICAgICAgIGZpbGVSZWFkZXIucmVhZEFzQXJyYXlCdWZmZXIoYmxvYlNsaWNlLmNhbGwoZmlsZSwgc3RhcnQsIGVuZCkpCiAgICAgIH0KICAgICAgbG9hZE5leHQoKQogICAgfSwKICAgIGNyZWF0ZWZvbGRlcigpCiAgICB7CiAgICAgIHRoaXMuJGh0dHAyLnB1dCh0aGlzLkNvbW1vbi5iYXNldXJsKyIvYXBpL2RpcnMvIiwgCiAgICAgIHsKICAgICAgICAibmFtZSI6IHRoaXMubmV3Zm9sZGVybmFtZSwKICAgICAgICAicGFyZW50X2lkIjogdGhpcy5jdXJyZW50X2Rpcl9pZAogICAgICB9LCAKICAgICAgewogICAgICAgIGhlYWRlcnM6IHsneC1hdXRoLXRva2VuJzogdGhpcy5Db21tb24ueHRva2VufQogICAgICB9KQogICAgICAudGhlbihyZXNwb25zZSA9PiB7CiAgICAgICAgICBpZiAocmVzcG9uc2Uuc3RhdHVzID09IDIwMCkgewogICAgICAgICAgICB0aGlzLiRub3RpZnkoe3RpdGxlOiAnTm90aWZpY2F0aW9uJyxtZXNzYWdlOiAnU3VjY2VzcyEnLGR1cmF0aW9uOiAzMDAwfSk7CiAgICAgICAgICAgIHZhciBuZXh0ZGlyPXtkaXJJRDogdGhpcy5jdXJyZW50X2Rpcl9pZH0KICAgICAgICAgICAgdGhpcy5mbHVzaERpcihuZXh0ZGlyKTsKICAgICAgICAgIH0KICAgICAgfSkKICAgICAgLmNhdGNoKGZ1bmN0aW9uIChlcnJvcikgewogICAgICAgIGFsZXJ0KCJFcnJvcjogIitlcnJvci5yZXNwb25zZS5kYXRhLm1zZyk7CiAgICAgIH0pOwogICAgICB0aGlzLm5ld2ZvbGRlcnNob3c9ZmFsc2U7CiAgICB9LAogICAgYmFja3ByZWRpcigpCiAgICB7CiAgICAgIHZhciBuZXh0ZGlyPXtkaXJJRDogdGhpcy5wcmVfZGlyX2lkfQogICAgICBpZih0aGlzLnByZV9kaXJfaWQgIT0gMCkKICAgICAgewogICAgICAgIHRoaXMuZmx1c2hEaXIobmV4dGRpcik7CiAgICAgIH0KICAgIH0KICB9LAogIGNyZWF0ZWQ6IGZ1bmN0aW9uICgpIAogIHsKICAgIHRoaXMuJGJ1cy5vbigndXBkYXRlRGlySUQnLCB0aGlzLmZsdXNoRGlyKTsKICB9LAogIG1vdW50ZWQ6IGZ1bmN0aW9uICgpIAogIHsKICAgIHRoaXMuJHJlZnMuc2V0aGVpZ2h0LnN0eWxlLmhlaWdodCA9ICgodGhpcy4kcmVmcy5nZXRoZWlnaHQub2Zmc2V0SGVpZ2h0KSowLjgwKSsncHgnOwogICAgdGhpcy4kYXBpLmdldCgnL2FwaS9kaXJzJywgCiAgICB7CiAgICAgICd4LWF1dGgtdG9rZW4nOiB0aGlzLkNvbW1vbi54dG9rZW4KICAgIH0sCiAgICB7ICAgICAgICAgICAgICAgICAgICAgIC8vJ2pvaG53aWNrMTIzQGdtYWlsLmNvbScsCiAgICAgIG9ubHlfZGlyOiBmYWxzZSAgICAgICAgICAgICAgICAgICAgICAgLy8nMTIzMTIzNCcKICAgIH0sIHJlc3BvbnNlID0+IHsKICAgIGlmIChyZXNwb25zZS5zdGF0dXMgPT0gMjAwKSAKICAgIHsKICAgICAgdmFyIGZvbGRlcnNsaXN0OwogICAgICB2YXIgZmlsZXNsaXN0OwoKICAgICAgdGhpcy5jdXJyZW50X2Rpcl9pZD1yZXNwb25zZS5kYXRhLnJlc3VsdF9kYXRhLmN1cnJfaWQ7CiAgICAgIHRoaXMucHJlX2Rpcl9pZD1yZXNwb25zZS5kYXRhLnJlc3VsdF9kYXRhLnByZV9pZDsKICAgICAgZm9sZGVyc2xpc3QgPSByZXNwb25zZS5kYXRhLnJlc3VsdF9kYXRhLmRpcnM7CiAgICAgIGZpbGVzbGlzdCA9IHJlc3BvbnNlLmRhdGEucmVzdWx0X2RhdGEuZmlsZXM7CiAgICAgIGZvciAodmFyIGtleWZvbGRlciBpbiBmb2xkZXJzbGlzdCkKICAgICAgewogICAgICAgIHRoaXMuZm9sZGVyaXRlbXMucHVzaCh7Z2V0bmFtZTogZm9sZGVyc2xpc3Rba2V5Zm9sZGVyXS5uYW1lLCBnZXRpZDogZm9sZGVyc2xpc3Rba2V5Zm9sZGVyXS5pZCwgZ2V0cHJlaWQ6IHRoaXMuY3VycmVudF9kaXJfaWQsZ2V0ZGF0ZTogZm9sZGVyc2xpc3Rba2V5Zm9sZGVyXS5jcmVhdGVfZGF0ZX0pOwogICAgICB9CiAgICAgIGZvciAodmFyIGtleWZpbGUgaW4gZmlsZXNsaXN0KQogICAgICB7CiAgICAgICAgdGhpcy5maWxlaXRlbXMucHVzaCh7Z2V0bmFtZTogZmlsZXNsaXN0W2tleWZpbGVdLm5hbWUrIi4iK2ZpbGVzbGlzdFtrZXlmaWxlXS5zdWZmaXhlcywgZ2V0c2l6ZTogZmlsZXNsaXN0W2tleWZpbGVdLnNpemUsIGdldGlkOiBmaWxlc2xpc3Rba2V5ZmlsZV0uaWQsIGdldHByZWlkOiB0aGlzLmN1cnJlbnRfZGlyX2lkLGdldGRhdGU6ZmlsZXNsaXN0W2tleWZpbGVdLmNyZWF0ZV9kYXRlfSk7CiAgICAgIH0KICAgICAgCiAgICB9IAogICAgZWxzZSBpZihyZXNwb25zZS5zdGF0dXMgPT0gNDAwKQogICAgewogICAgICBhbGVydChyZXNwb25zZS5kYXRhLm1zZyk7CiAgICAgIAogICAgfQogICAgZWxzZQogICAgewogICAgICBhbGVydCgiTmV0d29yayBFcnJvciIpOwogICAgfQogICAgfSk7CiAgfQp9Cg=="},{"version":3,"sources":["Filemanagement.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA+CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Filemanagement.vue","sourceRoot":"src/components/subpage","sourcesContent":["<template>\n  <div ref=\"getheight\" class=\"filemanagement\">\n    <el-container style=\"width:99%; margin: 0px; padding: 0px;  border:0px;\">\n      <el-header class=\"toolview\">\n      <el-upload\n        style=\"float:left;margin-right:1%\"\n          action=\"123\"\n          :http-request=\"upload\"\n          :with-credentials=\"true\"\n          :show-file-list=\"false\">\n          <el-button type=\"primary\" style=\"width:120px;\">Upload</el-button>\n        </el-upload>\n        <el-popover\n          placement=\"top\"\n          width=\"400\"\n          v-model=\"newfoldershow\">\n          <div>\n            <el-input v-model=\"newfoldername\" style=\"float:left;width:85%\"></el-input> \n            <el-button style=\"float:left;margin-left:3%\" type=\"primary\" icon=\"el-icon-check\" circle plain @click=\"createfolder\"></el-button>\n          </div>\n          <el-button slot=\"reference\" class=\"toolcompent\" type=\"primary\" plain>New Folder</el-button>\n        </el-popover>\n      </el-header>\n      <el-progress :style=\"uploadpercentageshow\" :percentage=\"uploadpercentage\"></el-progress>\n      <div style=\"margin-left:1%;\">\n        <p class=\"dirback\" style=\"float:left;font-size:1em;color:#409EFF;\" type=\"text\" @click=\"backpredir\">Back </p>\n        <p style=\"float: left;font-size:1em;margin-left:0.5%;\"> | {{current_dir_name}}</p>\n      </div>  \n      <div class=\"typemenu\">\n        <p style=\"text-align: left;margin:0;margin-left:2.3%;width:30%;float:left;\">file name</p>\n        <p style=\"text-align: left;margin:0;width:20%;float:left;\">size</p>\n        <p style=\"text-align: left;margin:0;width:20%;float:left;\">created date</p>\n      </div>\n      <div style=\"height:2%\"></div>\n      <div ref=\"setheight\" class=\"fileviewscroll\">\n        <div v-for=\"(item,index) in folderitems\" :key=\"'folder'+index\" style=\"padding: 0px;display:block;\">\n            <folderitem :foldername=\"item.getname\" :folderid=\"item.getid\" :folderpreid=\"item.getpreid\" :createddate=\"item.getdate\"></folderitem>\n        </div>\n        <div v-for=\"(item,index) in fileitems\" :key=\"'file'+index\">\n            <fileitem :filename=\"item.getname\" :filesize=\"item.getsize\" :fileid=\"item.getid\" :dirpreid=\"item.getpreid\" :createddate=\"item.getdate\"></fileitem>\n        </div>\n      </div>\n    </el-container>\n  </div>\n</template>\n\n<script>\nimport SparkMD5 from 'spark-md5';\nimport axios from 'axios';\nimport folderitem from \"./Fileitems/folderitem\";\nimport fileitem from \"./Fileitems/fileitem\";\nexport default {\n  name: 'Filemanagement',\n  data ()\n  {\n    return{\n      fileList:[{}],\n      folderitems: [],\n      fileitems: [],\n      current_dir_id: -1,\n      current_dir_name: 'All files',\n      pre_dir_id: 0,\n      newfoldershow: false,\n      newfoldername:\"\",\n      uploadpercentage:0,\n      uploadpercentageshow: \"display:none\",\n    };\n  },\n  components:\n  {\n    folderitem,\n    fileitem\n  },\n  methods:\n  {\n    flushDir(newDir)\n    {\n      this.current_dir_id = newDir.dirID;\n      this.folderitems = [];\n      this.fileitems = [];\n      this.$api.get('/api/dirs/'+this.current_dir_id,\n      {\n        'x-auth-token': this.Common.xtoken\n      }, \n      {\n        only_dir: false                       //'1231234'\n      }, response => {\n      if (response.status == 200) \n      {\n        var folderslist;\n        var fileslist;\n        this.pre_dir_id=response.data.result_data.pre_id;\n        if(response.data.result_data.pre_id == 0)\n        {\n          this.current_dir_name=\"All files\"\n        }\n        else\n        {\n          this.current_dir_name=response.data.result_data.name+\"/\"\n        }\n        folderslist = response.data.result_data.dirs;\n        fileslist = response.data.result_data.files;\n        for (var keyfolder in folderslist)\n        {\n          this.folderitems.push({getname: folderslist[keyfolder].name, getid: folderslist[keyfolder].id, getpreid: this.current_dir_id, getdate: folderslist[keyfolder].create_date});\n        }\n        for (var keyfile in fileslist)\n        {\n          this.fileitems.push({getname: fileslist[keyfile].name+\".\"+fileslist[keyfile].suffixes, getsize: fileslist[keyfile].size, getid: fileslist[keyfile].id, getpreid: this.current_dir_id,getdate:fileslist[keyfile].create_date});\n        }\n        \n      } \n      else if(response.status == 400)\n      {\n        alert(response.data.msg);\n        \n      }\n      else if(response.status == 403)\n      {\n        alert(response.data.msg);\n        \n      }\n      else\n      {\n        alert(\"Network Error\");\n        console.log(response);\n      }\n      });\n    },\n\n    upload(res)\n    {\n      let file = res.file;  //注意：直接上传file文件，不要用FormData对象的形式传\n\n      this.uploadpercentageshow=\"display:inline\";\n      this.generatorFileMd5(file);\n\n      //从接口获取presigned url\n              //需要用put方法上传，post会报405，aws官方规定是put方法\n      // axios.put(presignedUrl, file, config)\n      //     .then(res1 => {\n      //         if (res1.status == 200) {\n      //           console.log(res1);\n      //         }\n      //     });\n    },\n    generatorFileMd5(file) {\n      /**\n        * 生成MD5\n        */\n      let blobSlice = File.prototype.slice || File.prototype.mozSlice || File.prototype.webkitSlice\n        // file = this.files[0],\n      let chunkSize = 2097152                           // Read in chunks of 2MB\n      let chunks = Math.ceil(file.size / chunkSize)\n      let currentChunk = 0\n      let spark = new SparkMD5.ArrayBuffer()\n      let fileReader = new FileReader()\n      const _this=this;\n      fileReader.onload = function (e) {\n          // console.log('read chunk nr', currentChunk + 1, 'of', chunks)\n          spark.append(e.target.result)                  // Append array buffer\n          currentChunk++;\n\n          if (currentChunk < chunks) {\n              loadNext();\n          } else {\n              // console.info('computed hash', spark.end())  // spark.end(): 文件 MD5值生成完成\n              var md5code=spark.end();\n              _this.uploadpercentage=10;\n              _this.$api.get('/api/upload',\n              {\n                'x-auth-token': _this.Common.xtoken\n              }, \n              {\n                fileName: file.name,\n                fileSize: file.size,\n                fileMD5: md5code,\n                dirId: _this.current_dir_id\n              }, response => {\n              if (response.status == 200) \n              {\n                if(response.data.result_data.upload_url != null)\n                {\n                  var uploadurl;\n                  var uploadkey;\n                  uploadurl=response.data.result_data.upload_url;\n                  uploadkey=response.data.result_data.upload_key;\n                  let config = {headers: {'Content-Type': 'multipart/form-data'},\n                                 onUploadProgress: progressEvent => {\n                                  _this.uploadpercentage = parseInt((progressEvent.loaded / progressEvent.total * 90)+10);\n                                }};\n\n                    //从接口获取presigned url\n                            //需要用put方法上传，post会报405，aws官方规定是put方法\n                    axios.put(uploadurl, file, config)\n                    .then(res1 => {\n                        if (res1.status == 200) {\n                          var jsondata=JSON.stringify({\n                            \"file_name\": file.name,\n                            \"size\": file.size,\n                            \"md5\": md5code,\n                            \"dir_id\": _this.current_dir_id,\n                            \"upload_key\": uploadkey\n                          });\n                          _this.$http2.post(_this.Common.baseurl+\"/api/upload\", \n                          jsondata, \n                          {\n                            headers: {'x-auth-token': _this.Common.xtoken, 'Content-Type': 'application/json'}\n                          })\n                          .then(response => {\n                              if (response.status == 200) {\n                                _this.$notify({title: 'Notification',message: 'Success!',duration: 3000});\n                                var nextdir={dirID: _this.current_dir_id}\n                                _this.flushDir(nextdir);\n                                _this.uploadpercentageshow=\"display:none\";\n                              }\n                          })\n                          .catch(function (error) {\n                            console.log(error.response);\n                            _this.uploadpercentageshow=\"display:none\";\n                          });\n                        }\n                    })\n                    .catch(function (error) {\n                      console.log(error.response);\n                      _this.uploadpercentageshow=\"display:none\";\n                    });\n                }\n                else\n                {\n                  _this.$notify({title: 'Notification',message: 'Success!',duration: 3000});\n                  var nextdir={dirID: _this.current_dir_id}\n                  _this.flushDir(nextdir);\n                  _this.uploadpercentage=100;\n                  _this.uploadpercentageshow=\"display:none\";\n                }\n              } \n              else\n              {\n                alert(\"Error:\"+response.data.msg);\n                console.log(response);\n                _this.uploadpercentageshow=\"display:none\";\n              }\n              });\n\n          }\n      };\n\n      fileReader.onerror = function () {\n          console.warn('fileReader.onerror is error')\n      };\n\n      function loadNext() {\n          var start = currentChunk * chunkSize,\n              end = ((start + chunkSize) >= file.size) ? file.size : start + chunkSize;\n\n          fileReader.readAsArrayBuffer(blobSlice.call(file, start, end))\n      }\n      loadNext()\n    },\n    createfolder()\n    {\n      this.$http2.put(this.Common.baseurl+\"/api/dirs/\", \n      {\n        \"name\": this.newfoldername,\n        \"parent_id\": this.current_dir_id\n      }, \n      {\n        headers: {'x-auth-token': this.Common.xtoken}\n      })\n      .then(response => {\n          if (response.status == 200) {\n            this.$notify({title: 'Notification',message: 'Success!',duration: 3000});\n            var nextdir={dirID: this.current_dir_id}\n            this.flushDir(nextdir);\n          }\n      })\n      .catch(function (error) {\n        alert(\"Error: \"+error.response.data.msg);\n      });\n      this.newfoldershow=false;\n    },\n    backpredir()\n    {\n      var nextdir={dirID: this.pre_dir_id}\n      if(this.pre_dir_id != 0)\n      {\n        this.flushDir(nextdir);\n      }\n    }\n  },\n  created: function () \n  {\n    this.$bus.on('updateDirID', this.flushDir);\n  },\n  mounted: function () \n  {\n    this.$refs.setheight.style.height = ((this.$refs.getheight.offsetHeight)*0.80)+'px';\n    this.$api.get('/api/dirs', \n    {\n      'x-auth-token': this.Common.xtoken\n    },\n    {                      //'johnwick123@gmail.com',\n      only_dir: false                       //'1231234'\n    }, response => {\n    if (response.status == 200) \n    {\n      var folderslist;\n      var fileslist;\n\n      this.current_dir_id=response.data.result_data.curr_id;\n      this.pre_dir_id=response.data.result_data.pre_id;\n      folderslist = response.data.result_data.dirs;\n      fileslist = response.data.result_data.files;\n      for (var keyfolder in folderslist)\n      {\n        this.folderitems.push({getname: folderslist[keyfolder].name, getid: folderslist[keyfolder].id, getpreid: this.current_dir_id,getdate: folderslist[keyfolder].create_date});\n      }\n      for (var keyfile in fileslist)\n      {\n        this.fileitems.push({getname: fileslist[keyfile].name+\".\"+fileslist[keyfile].suffixes, getsize: fileslist[keyfile].size, getid: fileslist[keyfile].id, getpreid: this.current_dir_id,getdate:fileslist[keyfile].create_date});\n      }\n      \n    } \n    else if(response.status == 400)\n    {\n      alert(response.data.msg);\n      \n    }\n    else\n    {\n      alert(\"Network Error\");\n    }\n    });\n  }\n}\n</script>\n\n<!-- Add \"scoped\" attribute to limit CSS to this component only -->\n<style scoped lang=\"scss\">\n.filemanagement\n{\n  background-color:white;\n  margin: 0px;\n  padding: 0px;\n  height:100%;\n  width:100%;\n}\n.fileview\n{\n  text-align: left;\n}\n.toolview\n{\n  padding:0.5%;\n}\n.toolcompent\n{\n  float:left;\n  width:120px;\n}\n.fileviewscroll\n{\n  overflow-x:hidden; \n  border-top:1px solid #F2F6FD;\n}\n.typemenu\n{\n\n  width:100%;\n}\n.dirback:hover\n{\n  text-decoration: underline;\n}\n</style>\n"]}]}