{"remainingRequest":"/home/hobo/code/odd6871/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/hobo/code/odd6871/src/components/subpage/Fileshare.vue?vue&type=style&index=0&id=3815265f&scoped=true&lang=scss&","dependencies":[{"path":"/home/hobo/code/odd6871/src/components/subpage/Fileshare.vue","mtime":1588485150797},{"path":"/home/hobo/code/odd6871/node_modules/css-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/hobo/code/odd6871/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/home/hobo/code/odd6871/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/home/hobo/code/odd6871/node_modules/sass-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/hobo/code/odd6871/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/hobo/code/odd6871/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCi5maWxlc2hhcmUKewogIGJhY2tncm91bmQtY29sb3I6d2hpdGU7CiAgaGVpZ2h0OjEwMCU7Cn0K"},{"version":3,"sources":["Fileshare.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAoPA;AACA;AACA;AACA;AACA","file":"Fileshare.vue","sourceRoot":"src/components/subpage","sourcesContent":["<template>\n  <div class=\"fileshare\">\n    <el-table\n      ref=\"singleTable\"\n      :data=\"tableData\"\n      highlight-current-row\n      @current-change=\"handleCurrentChange\"\n      style=\"width: 100%;\">\n      <el-table-column\n        property=\"id\"\n        label=\"ID\"\n        min-width=\"4%\">\n      </el-table-column>\n      <el-table-column\n        property=\"name\"\n        label=\"File Name\"\n        min-width=\"10\">\n      </el-table-column>\n      <el-table-column\n        property=\"password\"\n        label=\"Password\"\n        min-width=\"10%\">\n      </el-table-column>\n      <el-table-column\n        property=\"maxdownloadtimes\"\n        label=\"Max Download Times\"\n        min-width=\"10%\">\n      </el-table-column>\n      <el-table-column\n        property=\"downloadedtimes\"\n        label=\"Downloaded times\"\n        min-width=\"10%\">\n      </el-table-column>\n      <el-table-column\n        property=\"deadline\"\n        label=\"Share Deadline\"\n        min-width=\"15%\">\n      </el-table-column>\n      <el-table-column\n        property=\"url\"\n        label=\"Share URL\"\n        min-width=\"20%\">\n      </el-table-column>\n    </el-table>\n    <div style=\"margin-top: 20px\">\n      <el-button style=\"float:left;margin-left: 3%;margin-right: 1%\" @click=\"shareupdateprepare\">Change config</el-button>\n      <el-button style=\"float:right;margin-right: 3%\" @click=\"deleteshare\">Delete share</el-button>\n    </div>\n\n    <el-dialog\n    title=\"Set up this share\"\n    :visible.sync=\"showdialogVisible\">\n      Deadline:\n      <el-date-picker\n        v-model=\"updatesharetime\"\n        style=\"margin-right:2%\"\n        type=\"datetime\"\n        placeholder=\"choose share time\">\n      </el-date-picker>\n      Limit times:\n      <el-input-number style=\"margin-right:2%\" v-model=\"updatesharelimit\" controls-position=\"right\" :min=\"-1\" :max=\"50\"></el-input-number>\n      Password:\n      <el-radio-group v-model=\"updatehaspassword\">\n        <el-radio-button label=\"True\"></el-radio-button>\n        <el-radio-button label=\"False\"></el-radio-button>\n      </el-radio-group>\n      <span slot=\"footer\" class=\"dialog-footer\">\n        <el-button @click=\"showdialogVisible = false\">Cancel</el-button>\n        <el-button type=\"primary\" @click=\"shareupdate \">Confirm</el-button>\n      </span>\n    </el-dialog>\n </div>\n\n\n</template>\n\n<script>\n\nexport default {\n  name: 'Fileshare',\n  data() {\n    return {\n      tableData: [],\n      currentRow: null,\n      showdialogVisible: false,\n      updatesharetime: \"\",\n      updatesharelimit: 0,\n      updatehaspassword: \"True\",\n    }\n  },\n  mounted: function () \n  {\n    this.getlist();\n    \n  },\n  methods:{\n    handleCurrentChange(val) {\n      this.currentRow = val;\n    },\n    deleteshare ()\n    {\n      if(this.currentRow != null)\n      {\n        this.$confirm('This operation will delete this share', 'Delete', {\n          confirmButtonText: 'Confirm',\n          cancelButtonText: 'Cancel',\n          type: 'warning'\n        }).then(() => {\n          this.$api.delete('/api/shares/'+this.currentRow.id, \n          {\n            'x-auth-token': this.Common.xtoken\n          }, \n          {\n          }, response => {\n          if (response.status == 200) \n          {\n            this.$message({type: 'success',message: 'Success!'});\n            console.log(response);  \n            this.tableData= [];\n            this.getlist();\n          } \n          else if(response.status == 400)\n          {\n            alert(response.data.msg);\n            \n          }\n          else\n          {\n            alert(\"Network Error\");\n            console.log(response);\n          }\n          });\n        }).catch(() => {\n          this.$message({\n            type: 'info',\n            message: 'Canceled'\n          });          \n        });\n      }\n    },\n    getlist ()\n    {\n      this.$api.get('/api/shares', \n      {\n        'x-auth-token': this.Common.xtoken\n      },\n      {                     \n      }, response => {\n      if (response.status == 200) \n      {\n        console.log(response);\n        var shareslist;\n\n        shareslist = response.data.result_data;\n\n        for (var key in shareslist)\n        {\n          this.tableData.push({id: shareslist[key].share_id, name: shareslist[key].name, password: shareslist[key].password,\n                                maxdownloadtimes: shareslist[key].limit_download_times, downloadedtimes: shareslist[key].download_times,\n                                deadline: shareslist[key].deadline, url:shareslist[key].share_url});\n        }\n        \n      } \n      else if(response.status == 400)\n      {\n        alert(response.data.msg);\n        \n      }\n      else\n      {\n        alert(\"Network Error\");\n      }\n      });\n    },\n    shareupdateprepare()\n    {\n      this.updatesharetime=new Date(this.currentRow.deadline);\n      this.updatesharelimit=this.currentRow.maxdownloadtimes;\n      if(this.currentRow.password == \"\")\n      {\n        this.updatehaspassword=\"False\";\n      }\n      else\n      {\n        this.updatehaspassword=\"True\";\n      }\n      this.showdialogVisible = true;\n    },\n    shareupdate()\n    {\n      this.showdialogVisible = false;\n      console.log(this.timeparse(this.updatesharetime));\n      var updatehaspassword;\n      if(this.updatehaspassword == \"False\")\n      {\n        updatehaspassword = false;\n      }\n      else\n      {\n        updatehaspassword =true;\n      }\n      this.$http2.post(this.Common.baseurl+\"/api/shares/\"+this.currentRow.id, \n      {\n        \"deadline\": this.timeparse(this.updatesharetime), \n        \"limit_download_times\": this.updatesharelimit,\n        \"has_password\": updatehaspassword\n      }, \n      {\n        headers: {'x-auth-token': this.Common.xtoken, 'Content-Type': 'application/json'}\n      })\n      .then(response => {\n          if (response.status == 200) {\n            this.$message({type: 'success',message: 'Success!'});\n            this.tableData=[];\n            this.getlist();\n          }\n      })\n      .catch(function (error) {\n        console.log(error.response);\n      });\n    },\n    timeparse(time)\n    {\n      var y,m,d,h,min,s;\n      y=time.getFullYear();\n      m=time.getMonth()+1;\n      if(m < 10)\n      {\n        m=\"0\"+m;\n      }\n      d=time.getDate();\n      if(d<10)\n      {\n        d=\"0\"+d;\n      }\n\n      return y+\"-\"+m+\"-\"+d+\" \"+time.toTimeString().split(\" \")[0];\n    }\n  }\n}\n</script>\n\n<!-- Add \"scoped\" attribute to limit CSS to this component only -->\n<style scoped lang=\"scss\">\n.fileshare\n{\n  background-color:white;\n  height:100%;\n}\n</style>\n"]}]}